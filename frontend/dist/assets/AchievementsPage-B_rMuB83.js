import{j as e}from"./index-BDMXBHNM.js";import{r as n}from"./reactrouter-DPorlkB3.js";const k=({achievement:s})=>e.jsx("div",{className:`bg-white/10 backdrop-blur-sm rounded-xl p-6 border transition-all duration-300 hover:scale-105 ${s.unlocked?"border-yellow-400/50 bg-gradient-to-br from-yellow-400/20 to-orange-500/20":"border-gray-600/50 bg-gray-800/50"}`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`text-4xl ${s.unlocked?"":"grayscale opacity-50"}`,children:s.icon||"🏆"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`font-bold text-lg mb-2 ${s.unlocked?"text-white":"text-gray-400"}`,children:s.name}),e.jsx("p",{className:`text-sm mb-3 ${s.unlocked?"text-gray-300":"text-gray-500"}`,children:s.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:`text-sm font-medium ${s.unlocked?"text-yellow-400":"text-gray-500"}`,children:s.unlocked?"✅ Unlocked":"🔒 Locked"}),s.points&&e.jsxs("div",{className:`text-sm font-bold ${s.unlocked?"text-yellow-400":"text-gray-500"}`,children:["⭐ ",s.points," pts"]})]}),s.unlocked&&s.unlockedAt&&e.jsxs("div",{className:"text-xs text-gray-400 mt-2",children:["Unlocked: ",new Date(s.unlockedAt).toLocaleDateString()]})]})]})}),T=({achievement:s,onClose:u,delay:i=0})=>{const[h,p]=n.useState(!1),[d,m]=n.useState(!1);n.useEffect(()=>{const g=setTimeout(()=>{p(!0)},i),x=setTimeout(()=>{c()},i+5e3);return()=>{clearTimeout(g),clearTimeout(x)}},[i]);const c=()=>{m(!0),setTimeout(()=>{u()},300)};return!h&&!d?null:e.jsx("div",{className:`fixed top-4 right-4 z-50 transition-all duration-300 ${h&&!d?"translate-x-0 opacity-100":"translate-x-full opacity-0"}`,children:e.jsxs("div",{className:"bg-gradient-to-r from-yellow-400 to-orange-500 text-white rounded-lg shadow-2xl p-4 max-w-sm border-2 border-yellow-300",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-3xl animate-bounce",children:s.icon||"🏆"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-lg mb-1",children:"Achievement Unlocked!"}),e.jsx("h5",{className:"font-semibold text-yellow-100 mb-2",children:s.name}),e.jsx("p",{className:"text-sm text-yellow-50 mb-3",children:s.description}),s.points&&e.jsxs("div",{className:"text-sm font-bold text-yellow-200",children:["⭐ +",s.points," points earned!"]})]}),e.jsx("button",{onClick:c,className:"text-yellow-200 hover:text-white transition-colors",children:"✕"})]}),e.jsx("div",{className:"mt-3 bg-yellow-300/20 rounded-full h-1",children:e.jsx("div",{className:"bg-yellow-300 h-1 rounded-full animate-pulse"})})]})})},S=()=>{const[s,u]=n.useState([]),[i,h]=n.useState({totalUnlocked:0,totalPoints:0}),[p,d]=n.useState(!0),[m,c]=n.useState(null),[g,x]=n.useState([]),[a,w]=n.useState("all"),[f,v]=n.useState(!1),b=async()=>{try{c(null),d(!0),console.log("🔍 Fetching achievements from /api/achievements...");const t=await fetch("/api/achievements",{credentials:"include",headers:{"Content-Type":"application/json"}});if(console.log("📡 Response status:",t.status),console.log("📡 Response headers:",Object.fromEntries(t.headers.entries())),!t.ok){const o=await t.text();throw console.error("❌ Server error response:",o.substring(0,500)),t.status===401?new Error("Please log in to view achievements"):t.status===404?new Error("Achievements endpoint not found"):new Error(`Server error: ${t.status} - ${t.statusText}`)}const l=t.headers.get("content-type");if(console.log("📄 Content-Type:",l),!l||!l.includes("application/json")){const o=await t.text();throw console.error("❌ Received non-JSON response:",o.substring(0,500)),new Error("Server returned HTML instead of JSON. Check if /api/achievements route exists.")}const r=await t.json();if(console.log("✅ Parsed JSON data:",r),r.success){u(r.achievements||[]),h(r.stats||{totalUnlocked:0,totalPoints:0,completionPercentage:0});const o=(r.achievements||[]).filter(y=>y.unlocked&&!y.previouslyUnlocked);o.length>0&&x(o)}else throw new Error(r.error||"Failed to load achievements")}catch(t){console.error("❌ Fetch error:",t),c(t.message)}finally{d(!1)}},N=async()=>{try{v(!0),c(null),console.log("🔍 Checking for new achievements at /api/achievements/check...");const t=await fetch("/api/achievements/check",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});if(console.log("📡 Check response status:",t.status),!t.ok){const o=await t.text();throw console.error("❌ Check server error response:",o.substring(0,500)),t.status===401?new Error("Please log in to check achievements"):t.status===404?new Error("Achievement check endpoint not found"):new Error(`Server error: ${t.status} - ${t.statusText}`)}const l=t.headers.get("content-type");if(console.log("📄 Check Content-Type:",l),!l||!l.includes("application/json")){const o=await t.text();throw console.error("❌ Check received non-JSON response:",o.substring(0,500)),new Error("Server returned HTML instead of JSON for achievement check.")}const r=await t.json();if(console.log("✅ Check parsed JSON data:",r),r.success)await b(),r.newlyUnlocked&&r.newlyUnlocked.length>0&&x(r.newlyUnlocked);else throw new Error(r.error||"Failed to check achievements")}catch(t){console.error("❌ Check achievements error:",t),c(t.message)}finally{v(!1)}};n.useEffect(()=>{b()},[]);const j=s.filter(t=>a==="all"?!0:a==="unlocked"?t.unlocked:a==="locked"?!t.unlocked:t.category===a);return p?e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-purple-400 mx-auto mb-4"}),e.jsx("div",{className:"text-xl text-white font-semibold",children:"Loading your achievements..."}),e.jsx("div",{className:"text-purple-300 mt-2",children:"Unlocking your progress"})]})}):m?e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",role:"alert",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-red-600 mr-2",children:"⚠️"}),e.jsx("h3",{className:"text-red-800 font-semibold",children:"Something went wrong"})]}),e.jsx("p",{className:"text-red-700 text-sm mt-1",children:m}),e.jsx("button",{onClick:b,className:"mt-3 px-4 py-2 bg-red-600 text-white rounded text-sm hover:bg-red-700 transition-colors",children:"Try Again"})]})}):e.jsx("div",{children:e.jsxs("div",{className:"max-w-5xl mx-auto p-6",children:[g.map((t,l)=>e.jsx(T,{achievement:t,onClose:()=>{x(r=>r.filter(o=>o.id!==t.id))},delay:l*1e3},t.id)),e.jsxs("div",{className:"text-center mb-8 pt-8",children:[e.jsx("div",{className:"inline-block p-4 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full mb-4 shadow-2xl",children:e.jsx("span",{className:"text-6xl",children:"🏆"})}),e.jsx("h1",{className:"text-5xl font-bold mb-4 text-white drop-shadow-lg",children:"Achievements"}),e.jsx("p",{className:"text-xl text-white max-w-2xl mx-auto drop-shadow-md",children:"Track your progress, unlock rewards, and showcase your GitHub journey! 🌟"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 border border-white/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold mb-1",children:i.totalUnlocked}),e.jsx("div",{className:"text-white/70 text-sm",children:"Achievements Unlocked"})]}),e.jsx("div",{className:"text-5xl opacity-80",children:"🏆"})]})}),e.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 border border-white/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold mb-1",children:i.totalPoints}),e.jsx("div",{className:"text-white/70 text-sm",children:"Total Points"})]}),e.jsx("div",{className:"text-5xl opacity-80",children:"⭐"})]})}),e.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 border border-white/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-3xl font-bold mb-1",children:[s.length>0?Math.round(i.totalUnlocked/s.length*100):0,"%"]}),e.jsx("div",{className:"text-white/70 text-sm",children:"Completion Rate"})]}),e.jsx("div",{className:"text-5xl opacity-80",children:"📊"})]})})]}),e.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 mb-8 border border-white/20",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"Filter Achievements"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:[{key:"all",label:"All",icon:"📚"},{key:"unlocked",label:"Unlocked",icon:"✅"},{key:"locked",label:"Locked",icon:"🔒"},{key:"social",label:"Social",icon:"👥"},{key:"productivity",label:"Productivity",icon:"⚡"},{key:"exploration",label:"Exploration",icon:"🗺️"},{key:"special",label:"Special",icon:"✨"}].map(t=>e.jsxs("button",{onClick:()=>w(t.key),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 flex items-center gap-2 ${a===t.key?"bg-gradient-to-r from-yellow-400 to-orange-500 text-white shadow-lg transform scale-105":"bg-white/20 text-white hover:bg-white/30 backdrop-blur-sm border border-white/30"}`,children:[e.jsx("span",{children:t.icon}),t.label]},t.key))})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:N,disabled:f,className:"px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 flex items-center gap-2",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Checking..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"🔄"}),"Check for New"]})}),e.jsxs("button",{onClick:async()=>{try{console.log("🧪 Testing API endpoint...");const l=await(await fetch("/api/achievements/test",{headers:{"Content-Type":"application/json"}})).json();console.log("🧪 Test result:",l),alert("API Test: "+JSON.stringify(l,null,2))}catch(t){console.error("🧪 Test failed:",t),alert("API Test Failed: "+t.message)}},className:"px-4 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 flex items-center gap-2 text-sm",children:[e.jsx("span",{children:"🧪"}),"Test API"]})]})]})}),j.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsx("div",{className:"text-8xl opacity-20 mb-4",children:"🏆"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"text-6xl animate-bounce",children:"🎯"})})]}),e.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:a==="all"?"Ready to Start Your Journey?":"No Achievements Found"}),e.jsx("p",{className:"text-gray-300 text-lg max-w-md mx-auto mb-6",children:a==="all"?"Begin exploring GitHub and unlock your first achievement! Every action brings you closer to mastery.":`No ${a} achievements match your current filter. Try a different category!`}),a!=="all"&&e.jsx("button",{onClick:()=>w("all"),className:"px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105",children:"Show All Achievements"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:j.map((t,l)=>e.jsx("div",{className:"animate-fade-in",style:{animationDelay:`${l*100}ms`},children:e.jsx(k,{achievement:t})},t.id))})]})})},E=()=>e.jsx("div",{className:"m-4",children:e.jsx(S,{})});export{E as default};
